{{ $activeMenu := newScratch }}
<header class="site-header" role="banner">
  <a href="{{ "/" | relURL }}" rel="home" class="site-logo">
    <img src="{{ "/img/logo-DIME-SHS.svg" | relURL }}" alt="{{ .Site.Title }}">
  </a>

  <nav class="main-navigation">
    <ul>
    {{ $currentPage := . }}
    {{ range .Site.Menus.main }}
    {{- $isActive := (or ($currentPage.IsMenuCurrent "main" .) (eq .Page $currentPage.Parent)) -}}
    {{ if $isActive }}{{ $activeMenu.Set "active" .Page }}{{ end }}
    <li class="navigation-item{{ if $isActive }} navigation-item--active active{{end}}">
      <a href="{{ (index .Page.Pages 0).URL }}">{{ .Title | default .Page.Title }}</a>
    </li>
    {{ end }}
    </ul>
  </nav>

  <nav class="secondary-navigation">
    <ul>
    {{ range .Site.Menus.subnav }}
    {{- if eq ($activeMenu.Get "active") .Page.Parent -}}
    {{- $isActive := ($currentPage.IsMenuCurrent "subnav" .) -}}
    <li class="navigation-item{{ if $isActive }} navigation-item--active active{{end}}">
      <a href="{{ .URL }}">{{ .Title | default .Page.Title }}</a>
    </li>
    {{ end }}{{ end }}
    </ul>
  </nav>

  <aside class="language-picker">
    <ul>
      {{ range $.Site.Home.AllTranslations }}
      {{ $Language := . }}
      <li style="{{ if eq $.Lang .Lang }}font-weight:bold{{ end }}">
        {{ $Translation := index (where $.Translations "Lang" .Lang) 0 }}
        {{ if (default "" $Translation) }}
        <a href="{{ $Translation.URL }}" lang="{{ $Language.Lang }}">{{ $Translation.Language.LanguageName }}</a>
        {{ else if eq $.Lang .Lang }}
        {{ .Language.LanguageName }}
        {{ else }}
        <a href="{{ .Permalink }}">{{ .Language.LanguageName }}</a>
        {{ end }}
      </li>
      {{ end }}
    </ul>
  </aside>
</header>
